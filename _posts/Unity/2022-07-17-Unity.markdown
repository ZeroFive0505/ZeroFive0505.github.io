---
layout: post
title: Unity Topdown #9
date: 2022-07-17 07:14:01 +0900
categories: Unity
---

# 오브젝트 풀링 버그

전에 오브젝트 풀링이 잘 적용이 되는 줄 알았는데 몇몇 코드에서는 아직도 Instantiate를 기반으로 작성된 코드 때문에 에러가 종종 생겨서 그걸 찾고 고치느라 시간이 좀 걸렸다.. 적과 플레이어의 투사체는 모두 풀링으로 동작이 되게 했다. 앞으로는 풀링을 이용하게 되면 또 어디선가 Instantiate와 Destroy가 남아있지 않은지 꼭 확인해야겠다.

# 새롭게 추가된 무기

새롭게 추가된 무기와 기존에 추가된 무기에 대해서 다시 정리를 해봤다.

## 화염 방사기

![화염 방사기](https://imgur.com/PRLkidu.gif)

발사 키를 누르면 계속 화염이 방사되는 식으로 만들어보려다. 그냥 단발식으로 만드는게 구현이나 충돌처리가 편해질 것 같아서 단발형식으로 만들었다. 충돌체는 박스 충돌체를 이용해서 발사되는 순간부터 특정 시간동안 서서히 커지게 만들었다.

## 유탄 발사기

![유탄 발사기](https://imgur.com/UgKv7h2.gif)

유탄 발사기의 경우 바닥이나 벽에 충돌했을 경우 횟수를 세서 일정 횟수 이상이면 터지도록 했다. 생각보다 잘 안 튕겨서 시행착오가 많았는데.. 생성시 위로 약간의 힘을 주니 그제서야 바닥에 튕겨서 앞으로 나가는 것을 확인할 수 있었다. 유탄 발사기는 튕기는 양이나 세기를 좀 더 조정 해야 겠다.

## 유도 미사일

![유도 미사일](https://imgur.com/hhYZh7p.gif)

유도 미사일의 경우 플레이어 전방에 약간 랜덤한 각도로 분사되는 형식으로 만들었다. 만들고 나서 확인해보니 연기 파티클이 충돌되자마자 소멸이 되서 이게 약간 어색하고 거슬린다. 이걸 수정해야 겠다.

## 레이저

![레이저](https://imgur.com/JRfKWYU.gif)

레이저의 경우 기존의 투사체와 다른 방식으로 만들어야 했어서 좀 고민했는데 결국 라인 렌더러에 SphereCastAll을 써서 충돌을 감지하는 방식으로 했다. 레이저의 경우 또한 데미지를 주는 방식이 달라서 적이 일정 시간동안 레이저에 히트했을 경우 데미지를 주는 방식으로 만들었다.

## 미사일

![미사일](https://imgur.com/Mj3pZLP.gif)

미사일은 유도 미사일과 비슷하지만 파괴력이 더 강하게 설정했다. 이 미사일 또한 연기 파티클이 갑작스럽게 소멸해서 이걸 유도 미사일 수정하면서 같이 수정해야겠다.

## 머신건

![머신건](https://imgur.com/j0bKtrs.gif)

연사가 가능한 무기

## 샷건

![샷건](https://imgur.com/H2mBnwt.gif)

랜덤하게 퍼져나가서 가까운 거리가 아니면 생각보다 데미지를 주기가 어려웠는데 좀 조정해야할지도 모르겠다.

# 앞으로 추가, 수정해야 할 것

일단 연기 파티클을 좀 수정해야할듯 하고 아직 파티클들은 풀링으로 처리를 안 해서 파티클 풀링 처리와 그래픽을 좀 더 레트로 스타일로 보이게 하고싶어서.. 그거에 관한 작업 후 미니 보스같은 좀 더 긴장감 넘치는 적을 만들어 봐야겠다.