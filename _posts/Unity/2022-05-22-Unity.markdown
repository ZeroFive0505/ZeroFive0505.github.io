---
layout: post
title: Unity Topdown #4
date: 2022-05-22 13:08:39 +0900
categories: Unity
---

# 미니맵 기능 추가
![Imgur](https://imgur.com/GMOYiWN.gif)

생각보다 많은 시행착오가 있었던 미니맵 기능이었다.
카메라를 한대 더 만들고 직교투영으로 위에서 바라보고 거기서 렌더링된 장면을 렌더 텍스쳐에 출력시켜서 그 이미지를 UI로 띄우는 방식으로 했는데 몇몇 아이콘의 경우 렌더 텍스쳐에 계속 출력이 안되서 이 문제를 해결하는라 시간이 생각하는 것보다 더 걸렸었다... 

문제는 아이콘이 기본 재질에 불투명일때만 출력이 되고 모양도 이상해지는 문제였는데 범인은 이 코드였다.

```cs
 void Start()
    {
        targetCamera.SetReplacementShader(Shader.Find("Unlit/Color"), "RenderType");
    }
```

미니맵을 출력할때 좀 더 색깔 그대로로 출력하려고 이런식으로 쉐이더를 교체했었는데 이것 때문에 불투명 물체만 출력이 가능했던 것이었다.. 그래서 이걸 주석 처리하니 위와같이 깔끔하게 출력할 수 있었다.

# 드랍 아이템 추가

본격적으로 무기 작업을 시작하기전에 먼제 간단한 드랍 아이템 시스템과 픽업 시스템을 만들어보고자 했다.

![Imgur](https://imgur.com/OPxYYhu.gif)

적을 처치했을시 일정확률로 아이템을 드랍하며 주으면 빠른 속도로 연사가 가능하게 만들었다. 방을 클리어시 X마크도 미니맵에 띄우게 했다.

# 폭탄 추가

좀 다른 패턴의 적을 추가하고자해서 플레이어에게 접근하는 적을 만들어보았다. 그 결과는 다음과 같다.

![Imgur](https://imgur.com/9NLKAvg.gif)

플레이어에게 계속접근하다 일정 거리안으로 들어오면 폭탄이 가동되고 밝게 반짝거리기 시작하다가 일정시간이 지나면 터지도록 했다.

# 무기 교체 UI

![Imgur](https://imgur.com/LGuoMb1.gif)

플레이어를 항상 따라다니는 무기 교체UI를 만들었다. 일단 테스트여서 계속해서 보이게 만들었는데 이후에는 일정 시간이 지나면 서서히 사라지도록 해야겠다.